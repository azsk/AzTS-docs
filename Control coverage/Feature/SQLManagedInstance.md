## SQLManagedInstance

| ControlId | Dependent Azure API(s) and Properties | Control spec-let |
|-----------|-------------------------------------|------------------|
| <b>ControlId:</b><br>Azure_SQLManagedInstance_Audit_Enable_Vuln_Assessment<br><b>DisplayName:</b><br>Vulnerability assessment must be enabled on your SQL managed instances<br><b>Description: </b><br> Enable SQL managed instances vulnerability assessments with email admins option |<b>ARM API to get Vulnerability Assessment of a SQLManagedInstance: </b> <br> /subscriptions/{subscriptionId}<br>/resourceGroups/{resourceGroupName}<br>/providers/Microsoft.Sql<br>/managedInstances/{resourceName}<br>/vulnerabilityAssessments/default<br>?api-version=2018-06-01-preview <br><b>Properties:</b><br> properties.VulnerabilityAssessmentSetting.IsEnabled<br> properties.EmailSubscriptionAdmins <br> properties.StorageContainerPath <br> properties.Emails |<b>Passed: </b><br>All the following conditions are true - <br> a. Vulnerability assessment setting is enabled <br> b. Atleast one option to send email notification on alert is selected <br> c. Storage account container path is selected.<br><b>Failed: </b><br>Any one of the four conditions is false - <br> a. Vulnerability assessment setting is enabled <br> b. Atleast one option to send email notification on alert is selected <br> c. Storage account container path is selected. |
