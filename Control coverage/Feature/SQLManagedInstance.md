## SQLManagedInstance

| ControlId | Dependent Azure API(s) and Properties | Control spec-let |
|-----------|-------------------------------------|------------------|
| <b>ControlId:</b><br>Azure_SQLManagedInstance_Audit_Enable_Vuln_Assessment<br><b>DisplayName:</b><br>Vulnerability assessment must be enabled on your SQL managed instances<br><b>Description: </b><br> Enable SQL managed instances vulnerability assessments with email admins option |<b>ARM API to get Vulnerability Assessment of a SQLManagedInstance: </b> <br> /subscriptions/{subscriptionId}<br>/resourceGroups/{resourceGroupName}<br>/providers/Microsoft.Sql<br>/managedInstances/{resourceName}<br>/vulnerabilityAssessments/default<br>?api-version=2018-06-01-preview <br><b>Properties:</b><br> properties.VulnerabilityAssessmentSetting.IsEnabled<br> properties.EmailSubscriptionAdmins <br> properties.StorageContainerPath <br> properties.Emails |<b>Passed: </b><br>All the following conditions are true - <br> a. Vulnerability assessment setting is enabled <br> b. Atleast one option to send email notification on alert is selected <br> c. Storage account container path is selected.<br><b>Failed: </b><br>Any one of the four conditions is false - <br> a. Vulnerability assessment setting is enabled <br> b. Atleast one option to send email notification on alert is selected <br> c. Storage account container path is selected. |
| <b>ControlId:</b><br>Azure_SQLManagedInstance_DP_Use_Secure_TLS_Version<br><b>DisplayName:</b><br>Use approved version of TLS for Azure SQL Managed Instance<br><b>Description: </b><br> Use approved version of TLS for Azure SQL Managed Instance |<b>ARM API to list SQL Managed Instances and get relevant property: </b> <br> /subscriptions/{subscriptionId}<br>/providers/Microsoft.Sql<br>/managedInstances<br>?api-version=2021-02-01-preview <br><b>Properties:</b><br> properties.minimalTlsVersion |<b>Passed: </b><br>Minimal TLS version set to 1.2 or higher<br><b>Failed: </b><br>Any one of the conditions is true - <br> a. Minimal TLS version not set or 'None' <br> b. Minimal TLS version set to 1.0 or 1.1 |
