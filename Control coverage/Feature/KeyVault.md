| ControlId | Dependent Azure API(s) and Properties | Control Spec |
|-----------|-------------------------------------|------------------|
| <b>ControlId:</b><br>Azure_KeyVault_SI_Enable_SoftDelete<br><br><b>DisplayName:</b><br>Soft delete must be enabled to allow recovery of deleted Key Vault and any objects (keys, secrets, etc.) contained in it.<br><br><b>Description: </b><br> Soft delete must be enabled to allow recovery of deleted Key Vault and any objects (keys, secrets, etc.) contained in it. |<b> ARM API to list all the KeyVault configurations under the specified subscription: </b> <br> /subscriptions/{subscriptionId}/providers<br>/Microsoft.KeyVault/vaults<br>?api-version=2019-09-01 <br><br><b>Properties:</b><br> properties/enableSoftDelete| <b>Scope: </b> All KeyVault in a subscription<br><br><b>Config: </b>NA<br><br><b>Passed: </b><br>Soft delete is enabled for KeyVault.<br><br><b>Failed: </b><br>Soft delete is disabled for KeyVault. |
| <b>ControlId:</b><br>Azure_KeyVault_AuthZ_Configure_Advanced_Access_Policies<br><br><b>DisplayName:</b><br>Advanced access policies must be configured on a need basis.<br><br><b>Description: </b><br> Advanced access policies must be configured on a need basis. |<b> ARM API to list all the KeyVault configurations under the specified subscription: </b> <br> /subscriptions/{subscriptionId}/providers<br>/Microsoft.KeyVault/vaults<br>?api-version=2019-09-01 <br><br><b>Properties:</b><br> properties/enabledForDeployment<br> properties/enabledForDiskEncryption<br> properties/enabledForTemplateDeployment| <b>Scope: </b> All KeyVault in a subscription<br><br><b>Config: </b>NA<br><br><b>Passed: </b><br>All Advanced access policies are not enabled.<br><br><b>Failed: </b><br>All Advanced access policies are enabled. |
| <b>ControlId:</b><br>Azure_KeyVault_Audit_Enable_Diagnostics_Log<br><br><b>DisplayName:</b><br>Diagnostics logs must be enabled with a retention period of at least 365 days.<br><br><b>Description: </b><br> Diagnostics logs must be enabled with a retention period of at least 365 days. |<b> ARM API to fetch diagnostic settings for specified resource: </b> <br> /{resourceId}/providers/microsoft.insights<br>/diagnosticSettings?api-version=2017-05-01-preview <br><br><b>Properties:</b><br> properties/logs/enabled<br> properties/logs/retentionPolicy/enabled<br> properties/logs/retentionPolicy/days| <b>Scope: </b> All KeyVault in a subscription<br><br><b>Config: </b><br>DiagnosticRetentionPeriodForever:"0"<br>DiagnosticRetentionPeriodMin:"365"<br><br><b>Passed: </b><br>Diagnostic setting are correctly configured<br>i.e.Diagnostic setting is enabled <br>and retaining log for atleast 365 days.<br><br><b>Failed: </b><br>Diagnostic setting is diabled <br>or not retaining log for 365 days. |
