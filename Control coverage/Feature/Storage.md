## Storage

| ControlId | Dependent Azure API(s) and Properties | Control spec-let |
|-----------|-------------------------------------|------------------|
| <b>ControlId:</b><br>Azure_Storage_AuthN_Dont_Allow_Anonymous<br><b>DisplayName:</b><br>Ensure secure access to storage account containers.<br><b>Description: </b><br>The Access Type for containers must not be set to 'Anonymous'. | <b>ARM API to list Storage Account at subscription level: </b><br>/subscriptions/{subscriptionId}/providers<br>/Microsoft.Storage/storageAccounts?<br>api-version=2019-06-01 <br><b>Properties:</b><br>allowBlobPublicAccess, provisioningState, kind | <b>Passed: </b><br>Storage does not have any container with public access.<br><b>Failed: </b><br>Storage has at least one container with public access or provisioning state for storage is not 'Succeeded'.<br><b>Verify: </b><br>Not able to fetch container details for storage.<br><b>NotApplicable: </b><br>Storage is of type FileStorage.(Kind FileStorage does not support containers). |
| <b>ControlId:</b><br>Azure_Storage_DP_Encrypt_In_Transit<br><b>DisplayName:</b><br>Enable Secure transfer to storage accounts<br><b>Description:</b><br>HTTPS protocol must be used for accessing Storage Account resources | <b>ARM API to list Storage Account at subscription level:</b><br>/subscriptions/{subscriptionId}/providers<br>/Microsoft.Storage/storageAccounts?<br> api-version=2019-06-01<br><b>Properties:</b><br>properties.supportsHttpsTrafficOnly<br><b>Azure built-in policy: </b>Secure transfer to storage accounts should be enabled. | <b>Passed:</b><br>ASC assessment status is healthy. Storage supports encryption in transit using HTTPS protocol.<br><b>Failed:</b><br>ASC assessment status is unhealthy. Storage does not support encryption in transit using HTTPS protocol. <br>(or)<br> ASC assessment status is "NotApplicable" with "cause" as either "OffByPolicy" or "Exempt".<br><b>Verify:</b><br>ASC assessment status is not applicable (with "cause" other than "OffByPolicy" and "Exempt").<br><b>Note:</b>If ASC Assessment is not found for a resource, the ARM API is used for the evaluation.|
| <b>ControlId:</b><br>Azure_Storage_NetSec_Restrict_Network_Access<br><b>DisplayName:</b><br>Ensure that Firewall and Virtual Network access is granted to a minimal set of trusted origins<br><b>Description: </b><br> Ensure that Firewall and Virtual Network access is granted to a minimal set of trusted origins | <b> ARM API to list Storage Account at subscription level: </b><br>/subscriptions/{subscriptionId}/providers<br>/Microsoft.Storage/storageAccounts?<br> api-version=2019-06-01 <br><b>Properties:</b><br> properties.networkAcls.defaultAction | <b>Passed: </b><br>Firewall and Virtual Network restrictions are defined for the storage.<br><b>Failed: </b><br>No Firewall and Virtual Network restrictions are defined for the storage. |
| <b>ControlId:</b><br>Azure_Storage_DP_Use_Secure_TLS_Version<br><b>DisplayName:</b><br>Use approved version of TLS for Azure Storage<br><b>Description: </b><br> Use approved version of TLS for Azure Storage |<b>ARM API to list Storage Accounts and get relevant property: </b> <br> /subscriptions/{subscriptionId}<br>/providers/Microsoft.Storage<br>/storageAccounts<br>?api-version=2019-06-01 <br><b>Properties:</b><br> properties.minimumTlsVersion |<b>Passed: </b><br>Minimum TLS version set to 1.2 or higher<br><b>Failed: </b><br>Any one of the conditions is true - <br> a. Minimum TLS version not set (default 1.0)<br> b. Minimum TLS version set to 1.0 or 1.1 |
