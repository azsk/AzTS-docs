| ControlId | Dependent Azure API(s) and Properties | Control Spec |
|-----------|-------------------------------------|------------------|
| <b>ControlId:</b><br>Azure_VirtualMachineScaleSet_Audit_Enable_Diagnostics<br><br><b>DisplayName:</b><br>Diagnostics (IaaSDiagnostics extension on Windows; LinuxDiagnostic extension on Linux) must be enabled on Virtual Machine Scale Set.<br><br><b>Description: </b><br> Diagnostics (IaaSDiagnostics extension on Windows; LinuxDiagnostic extension on Linux) must be enabled on Virtual Machine Scale Set. |<b> ARM API to list all the VMSS configurations under the specified subscription: </b> <br> /subscriptions/{subscriptionId}/providers<br>/Microsoft.Compute/virtualMachineScaleSets<br>?api-version=2019-07-01 <br><br><b>Properties:</b><br> properties/storageProfile/osDisk/osType<br>properties/virtualMachineProfile/extensionProfile/extensions| <b>Scope: </b> All VMSS in a subscription<br><br><b>Config: </b><br> LinuxExtensionType:"LinuxDiagnostic"<br>LinuxExtensionPublisher:"Microsoft.OSTCExtensions"<br>WindowsExtensionType:"IaaSDiagnostics"<br>WindowsExtensionPublisher:"Microsoft.Azure.Diagnostics"<br><br><b>Passed: </b><br>Required diagnostics extension is present in VM Scale Set.<br><br><b>Failed: </b><br>Required diagnostics extension is missing in VM Scale Set. |
| <b>ControlId:</b><br>Azure_VirtualMachineScaleSet_Config_Enable_NSG<br><br><b>DisplayName:</b><br>NSG must be configured for Virtual Machine Scale Set.<br><br><b>Description: </b><br> NSG must be configured for Virtual Machine Scale Set. |<b> ARM API to get all the public IPs for the specified VMSS: </b> <br> /subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers<br>/Microsoft.Compute/virtualMachineScaleSets/{resourceName}/publicipaddresses<br>?api-version=2019-07-01 <br><br><b>Properties:</b><br> properties/ipAddress <br><br><b> ARM API to list all the VMSS configurations under the specified subscription: </b> <br> /subscriptions/{subscriptionId}/providers<br>/Microsoft.Compute/virtualMachineScaleSets<br>?api-version=2019-07-01 <br><br><b>Properties:</b><br> properties/virtualMachineProfile/networkProfile/networkInterfaceConfigurations/properties/networkSecurityGroup| <b>Scope: </b> All VMSS in a subscription<br><br><b>Config: </b>NA<br><br><b>Passed: </b><br>VMSS does not have any associated public IP<br>or NSG is configured for the VMSS.<br><br><b>Failed: </b><br>VMSS have associated public IP and no NSG<br> is configured for it. |
| <b>ControlId:</b><br>Azure_VirtualMachineScaleSet_Deploy_Monitoring_Agent<br><br><b>DisplayName:</b><br>Log analytics agent should be installed on Virtual Machine Scale Set.<br><br><b>Description: </b><br> Log analytics agent should be installed on Virtual Machine Scale Set. |<b> ARM API to list all the VMSS configurations under the specified subscription: </b> <br> /subscriptions/{subscriptionId}/providers<br>/Microsoft.Compute/virtualMachineScaleSets<br>?api-version=2019-07-01 <br><br><b>Properties:</b><br> properties/storageProfile/osDisk/osType<br>properties/virtualMachineProfile/extensionProfile/extensions| <b>Scope: </b> All VMSS in a subscription<br><br><b>Config: </b><br> LinuxExtensionType:"OmsAgentForLinux"<br>LinuxExtensionPublisher:"Microsoft.EnterpriseCloud.Monitoring"<br>WindowsExtensionType:"MicrosoftMonitoringAgent"<br>WindowsExtensionPublisher:"Microsoft.EnterpriseCloud.Monitoring"<br><br><b>Passed: </b><br>Required monitoring agent is present in VM Scale Set.<br><br><b>Failed: </b><br>Required monitoring agent is missing in VM Scale Set. |
