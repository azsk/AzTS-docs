| ControlId | Dependent Azure API(s) and Properties | Control Spec |
|-----------|-------------------------------------|------------------|
| <b>ControlId:</b><br>Azure_VirtualMachineScaleSet_Audit_Enable_Diagnostics<br><br><b>DisplayName:</b><br>Diagnostics (IaaSDiagnostics extension on Windows; LinuxDiagnostic extension on Linux) must be enabled on Virtual Machine Scale Set.<br><br><b>Description: </b><br> Diagnostics (IaaSDiagnostics extension on Windows; LinuxDiagnostic extension on Linux) must be enabled on Virtual Machine Scale Set. |<b> ARM API to list all the VMSS configurations under the specified subscription: </b> <br> /subscriptions/{0}/providers<br>/Microsoft.Compute/virtualMachineScaleSets<br>?api-version=2019-07-01 <br><br><b>Properties:</b><br> properties/storageProfile/osDisk/osType<br>properties/virtualMachineProfile/extensionProfile/extensions| <b>Scope: </b> All VMSS in a subscription<br><br><b>Config: </b><br> LinuxExtensionType:"LinuxDiagnostic"<br>LinuxExtensionPublisher:"Microsoft.OSTCExtensions"<br>WindowsExtensionType:"IaaSDiagnostics"<br>WindowsExtensionPublisher:"Microsoft.Azure.Diagnostics"<br><br><b>Passed: </b><br>Required diagnostics extension is present in VM Scale Set.<br><br><b>Failed: </b><br>Required diagnostics extension is missing in VM Scale Set. |
