## Kubernetes Service

| ControlId | Dependent Azure API(s) and Properties | Control spec-let |
|-----------|-------------------------------------|------------------|
| <b>ControlId:</b><br>Azure_KubernetesService_AuthN_Enabled_AAD<br><b>DisplayName:</b><br>AAD should be enabled in Kubernetes Service.<br><b>Description: </b><br> AAD should be enabled in Kubernetes Service. | <b> ARM API to list Container Services at subscription level: </b> <br> /subscriptions/{subscriptionId}/providers/Microsoft.ContainerService/managedClusters? <br> api-version=2020-09-01 <br><b>Properties:</b><br> properties.clientAppID <br> properties.serverAppID <br> properties.tenantID <br> properties.managed | <b>Passed: </b><br> Azure AD applications (Server App and Client App) **are configured** for Kubernetes Service for authentication of the credentials provided by the client. <br><b>Failed: </b><br>Azure AD applications (Server App and Client App) **are not configured** for Kubernetes Service for authentication of the credentials provided by the client.|
| <b>ControlId:</b><br>Azure_KubernetesService_Deploy_Enable_Cluster_RBAC<br><b>DisplayName:</b><br>Cluster RBAC must be enabled in Kubernetes Service.<br><b>Description: </b><br> Cluster RBAC must be enabled in Kubernetes Service. | <b> ARM API to list Container Services at subscription level: </b> <br> /subscriptions/{subscriptionId}/providers/Microsoft.ContainerService/managedClusters?api-version=2020-09-01 <br><b>Properties:</b><br> properties.enableRBAC | <b>Passed: </b><br> RBAC is enabled for AKS.<br><b>Failed: </b><br>RBAC is disabled for AKS. |
| <b>ControlId:</b><br>Azure_KubernetesService_Audit_Enable_Diagnostics_Log<br><b>DisplayName:</b><br>Diagnostics logs must be enabled for Kubernetes service.<br><b>Description: </b><br>Diagnostics logs must be enabled for Kubernetes service. | <b>ARM API to list diagnostic setting details of Kubernetes service resources: </b> </br> /subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}<br>/providers/Microsoft.Kubernetes/connectedClusters/{serviceName}/providers<br>/microsoft.insights/diagnosticSettings?api-version=2017-05-01-preview <br><b>Properties:</b><br> name <br>properties.logs.category <br> properties.logs.enabled <br> properties.logs.retentionPolicy.enabled <br> properties.logs.retentionPolicy.days <br> properties.workspaceId <br> properties.storageAccountId <br> properties.eventHubName <br>|<b>Scope: </b> All Kubernetes service resources in subscription.<br><br> <b>Config: </b><br> DiagnosticLogs: kube-apiserver, <br> kube-audit, kube-audit-admin, Guard <br> DiagnosticMinRetentionPeriod : 365  <br> DiagnosticForeverRetentionValue : 0 <br><br> <b>Passed: </b><br>1. Required diagnostic logs are enabled.<br> *and* <br> 2. At least one of the below setting configured:<br> a. Log Analytics. <br> b. Storage account (with min Retention period of 365 or forever(Retention period 0). <br> c. Event Hub. <br><b>Failed: </b><br>1. Diagnostics setting is disabled for resource. <br> *or* <br> 2. Diagnostic setting meet the following conditions: <br> a. All diagnostic logs are not enabled. <br> b. None of the below setting is configured: <br> i. Log Analytics.<br> ii. Storage account (with min Retention period of 365 or forever(Retention period 0).<br> iii. Event Hub. <br> <b>Error</b> <br>Required logs are not configured in control settings.|