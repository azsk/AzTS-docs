## Service Fabric

| ControlId | Dependent Azure API(s) and Properties | Control spec-let |
|-----------|-------------------------------------|------------------|
| <b>ControlId:</b><br> Azure_ServiceFabric_DP_Dont_Expose_Reverse_Proxy_Port <br><b>DisplayName:</b><br>Reverse proxy port must not be exposed publicly. <br><b>Description: </b><br> Reverse proxy port must not be exposed publicly.| <b> ARM API to get the list of Service Fabric cluster resources created in the specified subscription - Gets all Service Fabric cluster resources created or in the process of being created in the subscription. </b> <br> /subscriptions/{subscriptionId}/providers/Microsoft.ServiceFabric/clusters?<br>api-version=2018-02-01<br><b>Properties:</b><br> properties.nodeTypes[\*].reverseProxyEndpointPort <br> <br> <b> ARM API to get all the load balancers in a subscription. </b> /subscriptions/{subscriptionId}/providers/Microsoft.Network/loadBalancers? <br> api-version=2019-12-01 <br><b>Properties:</b><br> Tags <br> backendAddressPools[].properties. backendIPConfigurations[].id | <b>Passed: </b><br>Reverse proxy endpoints ports list is empty. <br><b>Failed: </b><br>Reverse proxy endpoints ports found and ports are opened using public load balancer on SF.|
| <b>ControlId:</b><br>Azure_ServiceFabric_DP_Set_Property_ClusterProtectionLevel<br><b>DisplayName:</b><br> The ClusterProtectionLevel property must be set to EncryptAndSign. <br><b>Description: </b><br> The ClusterProtectionLevel property must be set to EncryptAndSign.|<b> ARM API to get the list of Service Fabric cluster resources created in the specified subscription - Gets all Service Fabric cluster resources created or in the process of being created in the subscription. </b> <br> /subscriptions/{subscriptionId}/providers/Microsoft.ServiceFabric/clusters? <br> api-version=2018-02-01 <br><b>Properties:</b><br> fabricSettings.Security.ClusterProtectionLevel<br><b>Azure built-in policy:</b> Service Fabric clusters should have the ClusterProtectionLevel property set to EncryptAndSign. | <b>Passed: </b><br>ASC assessment status is healthy. Cluster protection level is set to "EncryptAndSign".<br><b>Failed: </b><br>ASC assessment status is unhealthy. Cluster protection level is not set to "EncryptAndSign". (or) ASC assessment status is "NotApplicable" with "cause" as either "OffByPolicy" or "Exempt".<br><b>Verify:</b><br>ASC assessment status is not applicable (with "cause" other than "OffByPolicy" and "Exempt").<br><b>Note:</b> If ASC Assessment is not found for a resource, the ARM API is used for the evaluation.
| <b>ControlId:</b><br>Azure_ServiceFabric_AuthN_NSG_Enabled<br><b>DisplayName:</b><br> Firewall/NSGs must be enabled on subnet of Service Fabric cluster. <br><b>Description: </b><br> Network security group (NSG) must be enabled on subnets of Service Fabric cluster.|<b> ARM API to list Service Fabric cluster resources at subscription level: </b> <br> /subscriptions/{subscriptionId}/providers/Microsoft.ServiceFabric/clusters<br>?api-version=2018-02-01 <br><b>Properties:</b><br> properties.nodeTypes[\*].name <br><br><b> ARM API to list Virtual Machine scale sets at subscription level:</b><br> /subscriptions/{subscriptionId}/providers/Microsoft.Compute<br>/virtualMachineScaleSets<br>?api-version=2019-07-01 <br><b>Properties:</b><br> tags, properties.virtualMachineProfile.networkProfile.<br>networkInterfaceConfigurations[\*].properties.ipConfigurations[\*]<br>.properties.subnet.id <br><br><b>ARM API to list Virtual Networks at <br>subscription level:</b><br>/subscriptions/{subscriptionId}/providers<br>/Microsoft.Network/virtualNetworks<br>?api-version=2019-11-01<br><b>Property:</b><br>networkSecurityGroup/id<br><br><b>ARM API to list Network Security Groups at <br>subscription level:</b><br>/subscriptions/{subscriptionId}/providers<br>/Microsoft.Network/networkSecurityGroups<br>?api-version=2019-04-01<br><b>Property:</b><br>destinationPortRange, destinationPortRanges<br>| <b>Passed: </b><br> NSG is configured with no restricted ports (e.g. RDP 3389, SMB 445 etc.) open using NSG rules. <br><b>Failed: </b><br> NSG is not configured or any restricted ports (e.g. RDP 3389, SMB 445 etc.) are open using NSG rules. <br><b>Verify: </b><br> No linked Virtual Machine scale set node found. |
