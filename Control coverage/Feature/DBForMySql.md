## DBForMySql

| ControlId | Dependent Azure API(s) and Properties | Control spec-let |
|-----------|-------------------------------------|------------------|
| <b>ControlId:</b><br>Azure_DBforMySQL_Audit_Enable_ATP<br><b>DisplayName:</b><br>Enable Threat detection for MySQL database<br><b>Description: </b><br> Advanced Threat Protection must be enabled for Azure Database for MySQL |<b> ARM API to get security alert policy of a DBForMySql server: </b> <br> /subscriptions/{subscriptionId}<br>/resourceGroups/{resourceGroupName}<br>/providers/Microsoft.DBforMySQL<br>/servers/{serverName}<br>/securityAlertPolicies/Default<br>?api-version=2017-12-01 <br><b>Properties:</b><br> properties.state<br> properties.emailAccountAdmins <br> properties.emailAddresses <br> properties.disabledAlerts| <b>Passed: </b><br>ATP is enabled and 'email notifications to admins' are also enabled.<br><b>Failed: </b><br>Either MySQL is of 'basic tier' which does not support ATP. <br>Or ATP is disabled. <br>Or ATP is enabled but <br> 1. 'Email notifications to admins' is disabled as well as explicit email(s) are not configured. <br> 2. All 'Advanced threat protection types' are not enabled. |
| <b>ControlId:</b><br>Azure_DBforMySQL_NetSec_Dont_Allow_Universal_IP_Range<br><b>DisplayName:</b><br>Do not use Any-to-Any IP range for Azure Database for MySQL <br><b>Description: </b><br> Do not use Any-to-Any IP range for Azure Database for MySQL. | <b> ARM API to get firewall rules of a DBForMySql server: </b> <br> /subscriptions/{subscriptionId}<br>/resourceGroups/{resourceGroupName}<br>/providers/Microsoft.DBforMySQL<br>/servers/{serverName}<br>/firewallRules/{firewallRuleName}<br>?api-version=2017-12-01 <br><b>Properties:</b><br> name <br> properties.startIpAddress <br> properties.endIpAddress | <b>Passed: </b><br>No additional firewall rule or custom firewall rules without Any-to-Any IP range.<br><b>Failed: </b><br>Custom firewall rule with Any-to-Any IP range with Start IP address as 0.0.0.0 and End Ip address as 255.255.255.255 is found. |
| <b>ControlId:</b><br>Azure_DBforMySQL_Authz_Enable_SSL_Connection<br><b>DisplayName:</b><br>SSL connection must be enabled for Azure Database for MySQL <br><b>Description: </b><br> SSL connection must be enabled for Azure Database for MySQL. | <b> ARM API to get firewall rules of a DBForMySql server: </b> <br> /subscriptions/{subscriptionId}<br>/resourceGroups/{resourceGroupName}<br>/providers/Microsoft.DBforMySQL<br>/servers/{serverName}<br>/firewallRules/{firewallRuleName}<br>?api-version=2017-12-01 <br><b>Properties:</b><br> properties.sslEnforcement | <b>Passed: </b><br>SSL connection is enabled.<br><b>Failed: </b><br>SSL connection is disabled. |
| <b>ControlId:</b><br>Azure_DBforMySQL_DP_Use_Secure_TLS_Version<br><b>DisplayName:</b><br>Use approved version of TLS for Azure Database for MySQL <br><b>Description: </b><br> Use approved version of TLS for Azure Database for MySQL. | <b> ARM API to get resource details of a DBForMySql server: </b> <br> /subscriptions/{subscriptionId}<br>/providers/Microsoft.DBforMySQL<br>/servers?api-version=2017-12-01 <br><b>Properties:</b><br> properties.minimalTlsVersion | <b>Passed: </b><br> Current TLS version of Azure Database for MySQL is set to either equal or greater than the required minimum TLS version.<br><b>Failed: </b><br>1. Current TLS version of Azure Database for MySQL is less than the required minimum TLS version.<br>2. TLS for Azure Database for MySQL is not configured or SSL is disabled.<br><b>Error: </b><br>Required minimum TLS version is not set properly in control settings. |
| <b>ControlId:</b><br>Azure_DBforMySQL_Audit_Enable_Diagnostics_Log<br><b>DisplayName:</b><br>Diagnostics logs must be enabled for Azure Database for MySQL.<br><b>Description: </b><br>Diagnostics logs must be enabled for Azure Database for MySQL. | <b>ARM API to list diagnostic setting details of Azure Database for MySQL servers: </b> </br> /subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}<br>/providers/Microsoft.DBforMySQL/servers/{serverName}/providers<br>/microsoft.insights/diagnosticSettings?api-version=2017-05-01-preview <br><b>Properties:</b><br> name <br>properties.logs.category <br> properties.logs.enabled <br> properties.logs.retentionPolicy.enabled <br> properties.logs.retentionPolicy.days <br> properties.workspaceId <br> properties.storageAccountId <br> properties.eventHubName <br>|<b>Scope: </b> All DBforMySQL server resources in subscription.<br><br> <b>Config: </b><br> DiagnosticLogs: MySqlAuditLogs <br> DiagnosticMinRetentionPeriod : 365  <br> DiagnosticForeverRetentionValue : 0 <br><br> <b>Passed: </b><br>1. Required diagnostic logs are enabled.<br> *and* <br> 2. At least one of the below setting configured:<br> a. Log Analytics. <br> b. Storage account (with min Retention period of 365 or forever(Retention period 0). <br> c. Event Hub. <br><b>Failed: </b><br>1. Diagnostics setting is disabled for resource. <br> *or* <br> 2. Diagnostic setting meet the following conditions: <br> a. All diagnostic logs are not enabled. <br> b. None of the below setting is configured: <br> i. Log Analytics.<br> ii. Storage account (with min Retention period of 365 or forever(Retention period 0).<br> iii. Event Hub. <br> <b>Error</b> <br>Required logs are not configured in control settings.|