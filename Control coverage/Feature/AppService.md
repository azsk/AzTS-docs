## App Service

| ControlId | Dependent Azure API(s) and Properties | Control spec |
|-----------|-------------------------------------|------------------|
| <b>ControlId:</b><br>Azure_AppService_DP_Dont_Allow_HTTP_Access<br><b>DisplayName:</b><br>Use HTTPS for app services.<br><b>Description: </b><br> App Service must only be accessible over HTTPS. |<b> ARM API to list all the App Services in a subscription: </b> <br> /subscriptions/{subscriptionId}/providers/Microsoft.Web/sites? <br> 2018-11-01 <br><b>Properties:</b><br> properties.httpsOnly <br><br> <b> ARM API to list all deployment slots of an App Service: </b> <br> /subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/Microsoft.Web/sites/{name}/slots? <br> api-version=2019-08-01 <br><b>Properties:</b><br> properties.httpsOnly| <b>Passed: </b><br>HTTPS Only setting is enabled for all slots in App Service.<br><b>Failed: </b><br>HTTPS Only setting is disabled for any slot in App Service. |
| <b>ControlId:</b><br>Azure_AppService_DP_Use_Secure_TLS_Version<br><b>DisplayName:</b><br>Use Approved TLS Version in App Service.<br><b>Description: </b><br> Use approved version of TLS for the App Service. |<b> ARM API to get configuration of an App Service: </b> <br> /subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/Microsoft.Web/sites/{name}/config/web? <br> api-version=2018-11-01 <br><b>Properties:</b><br> properties.minTlsVersion <br><br> <b> ARM API to list all deployment slots of an App Service: </b> <br> /subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/Microsoft.Web/sites/{name}/slots? <br> api-version=2019-08-01 <br><b>Properties:</b><br> name <br><br> <b> ARM API to get configuration of an App Service slot: </b> <br> /subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/Microsoft.Web/sites/{name}/slots/{slotName}/config/web? <br> api-version=2019-08-01 <br><b>Properties:</b><br> properties.minTlsVersion| <b>Passed: </b><br>Current minimum TLS version is set to either equal or greater than the required min TLS version for all the slots in App Service.<br><b>Failed: </b><br>Current minimum TLS version is less than required min TLS version for any of the slot in App Service. |
| <b>ControlId:</b><br>Azure_AppService_Config_Disable_Remote_Debugging<br><b>DisplayName:</b><br>Remote debugging should be turned off for Web Applications.<br><b>Description: </b><br> Remote debugging must be turned off for App Service. |<b> ARM API to get configuration of an App Service: </b> <br> /subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/Microsoft.Web/sites/{name}/config/web? <br> api-version=2018-11-01 <br><b>Properties:</b><br> properties.remoteDebuggingEnabled <br><br> <b> ARM API to list all deployment slots of an App Service: </b> <br> /subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/Microsoft.Web/sites/{name}/slots? <br> api-version=2019-08-01 <br><b>Properties:</b><br> name <br><br> <b> ARM API to get configuration of an App Service slot: </b> <br> /subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/Microsoft.Web/sites/{name}/slots/{slotName}/config/web? <br> api-version=2019-08-01 <br><b>Properties:</b><br> properties.remoteDebuggingEnabled| <b>Passed: </b><br>Remote debugging is turned OFF for all slots in App Service.<br><b>Failed: </b><br>Remote debugging is turned ON for any of the slot in App Service. |
| <b>ControlId:</b><br>Azure_AppService_Config_Disable_Web_Sockets<br><b>DisplayName:</b><br>Web Sockets should be disabled for App Service. <br><b>Description: </b><br> Web Sockets should be disabled for App Service. | <b> ARM API to get configuration of an App Service: </b> <br> /subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/Microsoft.Web/sites/{name}/config/web?<br> api-version=2018-11-01 <br><b>Properties:</b><br> properties.webSocketsEnabled  <br><br> <b> ARM API to list all deployment slots of an App Service: </b> <br> /subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/Microsoft.Web/sites/{name}/slots? <br> api-version=2019-08-01 <br><b>Properties:</b><br> name <br><br> <b> ARM API to get configuration of an App Service slot: </b> <br> /subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/Microsoft.Web/sites/{name}/slots/{slotName}/config/web? <br> api-version=2019-08-01 <br><b>Properties:</b><br> properties.webSocketsEnabled| <b>Passed: </b><br>Web sockets is disabled for all slots in App Service.<br><b>Failed: </b><br>Web sockets is enabled for any of the slot in App Service. |
| <b>ControlId:</b><br>Azure_AppService_Audit_Enable_Logging_and_Monitoring<br><b>DisplayName:</b><br>Monitoring must be enabled for App Service. <br><b>Description: </b><br> Auditing and Monitoring must be enabled for App Service. | <b> ARM API to get configuration of an App Service: </b> <br> /subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/Microsoft.Web/sites/{name}/config/web?<br> api-version=2018-11-01 <br><b>Properties:</b><br> properties.detailedErrorLoggingEnabled, properties.httpLoggingEnabled, properties.requestTracingEnabled  <br><br> <b> ARM API to list all deployment slots of an App Service: </b> <br> /subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/Microsoft.Web/sites/{name}/slots? <br> api-version=2019-08-01 <br><b>Properties:</b><br> name <br><br> <b> ARM API to get configuration of an App Service slot: </b> <br> /subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/Microsoft.Web/sites/{name}/slots/{slotName}/config/web? <br> api-version=2019-08-01 <br><b>Properties:</b><br> properties.detailedErrorLoggingEnabled, properties.httpLoggingEnabled, properties.requestTracingEnabled| <b>Passed: </b><br>HTTP Logging, DetailedError Logging and Request Tracing, all three must be enabled for all slots in App Service.<br><b>Failed: </b><br>HTTP Logging, DetailedError Logging and Request Tracing, any one of the three logging is disabled for any slot of App Service. |
| <b>ControlId:</b><br>Azure_AppService_AuthZ_Configure_IP_Restrictions<br><b>DisplayName:</b><br>Setup IP-based access restrictions for App Service if feasible.<br><b>Description:</b><br>Setup IP-based access restrictions for App Service if feasible. | <b>ARM API to get configuration of an App Service:</b> <br> /subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/<br>providers/Microsoft.Web/sites/{name}/config/web?api-version=2018-11-01<br><b>Properties:</b><br>properties.ipSecurityRestrictions<br>properties.scmIpSecurityRestrictions<br>properties.scmIpSecurityRestrictionsUseMain | <b>Passed:</b><br>- SCM site relies on the App Service's IP Security Restrictions, and, there are IP Security Restrictions configured for the App Service.<br>- SCM site does not rely on the App Service's IP Security Restrictions, but, IP Security Restrictions have been configured for the SCM site.<br><b>Failed:</b><br>- SCM site relies on the App Service's IP Security Restrictions, but, no IP Security Restrictions have been configured for the App Service.<br>- SCM site does not rely on the App Service's IP Security Restrictions, and, no IP Security Restrictions have been configured for the SCM site. |
| <b>ControlId:</b><br>Azure_AppService_BCDR_Use_AlwaysOn<br><b>DisplayName:</b><br>'Always On' should be configured for App Service.<br><b>Description:</b><br>'Always On' should be configured for App Service. | <b>ARM API to get configuration of an App Service:</b> <br> /subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/<br>providers/Microsoft.Web/sites/{name}/config/web?api-version=2018-11-01<br><b>Properties:</b><br>properties.kind, properties.alwaysOn | <b>Passed:</b><br>"Always On" configuration is enabled for the App Service.<br><b>Failed:</b><br>"Always On" configuration is not enabled for the App Service.<br><b>NotApplicable:</b><br>Non "app" variants are excluded from the evaluation. |
| <b>ControlId:</b><br>Azure_AppService_BCDR_Use_Multiple_Instances<br><b>DisplayName:</b><br>App Service must be deployed on a minimum of two instances to ensure availability.<br><b>Description:</b><br>App Service must be deployed on a minimum of two instances to ensure availability. | <b>ARM API to list all the App Services in a subscription:</b><br>/subscriptions/{subscriptionId}/providers/Microsoft.Web/sites?2018-11-01<br><b>Properties:</b><br>properties.kind, properties.serverFarmId<br><b>ARM API to list all App Service Plans in a Subscription:</b> <br> /subscriptions/{subscriptionId}/providers/Microsoft.Web/<br>serverfarms?api-version=2019-08-01&&detailed=false<br><b>Properties:</b><br>properties.name, properties.sku.capacity | <b>Passed:</b><br>The App Service is deployed across the minimum required instances.<br><b>Failed:</b><br>The App Service is not deployed across the minimum required instances.<br><b>NotApplicable:</b><br>Non "app" variants are excluded from the evaluation. |
| <b>ControlId:</b><br>Azure_AppService_DP_Review_CORS_Request_Credential<br><b>DisplayName:</b><br>Review use of credentials in CORS request for App Service.<br><b>Description:</b><br>Review use of credentials in CORS request for App Service. | <b>ARM API to get configuration of an App Service:</b> <br> /subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/<br>providers/Microsoft.Web/sites/{name}/config/web?api-version=2018-11-01<br><b>Properties:</b><br>properties.cors | <b>Passed:</b><br>- App Service does not allow CORS.<br>- "Access-Control-Allow-Credentials" Header is disabled for the App Service.<br><b>Failed:</b><br>App Service allows CORS and "Access-Control-Allow-Credentials" Header is enabled for the App Service. |
| <b>ControlId:</b><br>Azure_AppService_DP_Use_CNAME_With_SSL<br><b>DisplayName:</b><br>Custom domain with SSL binding must be <br>configured for App Service.<br><b>Description:</b><br>Custom domain with SSL binding must be <br>configured for App Service. | <b>ARM API to list all the App Services in a subscription:</b><br> /subscriptions/{subscriptionId}/providers/Microsoft.Web/sites?api-version=2018-11-01<br><b>Properties:</b><br>properties.hostNames, properties.hostNameSslStates | <b>Passed:</b><br>SSL configuration for resource is enabled for all custom domains.<br><b>Failed:</b><br>- Custom domains are not configured.<br>- SSL configuration for resource is not enabled for all custom domains. |
